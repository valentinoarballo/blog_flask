{% extends 'layout.html' %}

{%block title%}
Inicio
{%endblock%}

{% block custom_css %}
<link rel="stylesheet" href="../static/css/main.css">
{% endblock %}

{%block body%}

{% for message in get_flashed_messages() %}
    <div class="alert alert-primary alert-dismissible fade show mt-4" role="alert">
        {{message}}
        <button type="button" class="close" data-dismiss="alert" aria-label="Close">
        <span aria-hidden="true">&times;</span>
        </button>
    </div>
{% endfor %}

<form class="row mx-0 mt-4" action="/agregar_publicacion" method="POST">
    <select class="col-12 p-2 my-2" name="autor" id="select">
        {% for usuario in usuarios %}
            <option value="{{usuario.nombre}}">{{usuario.nombre}}</option>
        {% endfor %}
    </select>
    <input class="form-control col-10 my-1" type="text" name="descripcion" placeholder="Publica algo">
    <button class="btn-submit btn btn-outline-primary p-0 col-2 my-1" type="submit" style="font-size: 25px;">➢</button>
</form>


<section class="border-bottom">
    <hr>
    <div class="row mx-0">
        {% for publicacion in publicaciones %}
        <div class="col-12 row m-0 mb-2 py-2 publicacion">
            <!-- seccion superior, perfil - nombre - fecha - dropdown  -->
            <div class="col-12 row py-2 px-0 mx-0">

                <!-- foto de perfil col-md-2 col-sm-2  -->
                <div class="col-md-1 col-2">
                    <img src="../static/img/gato{{ range(1, 18) | random }}.png" class="shadow-1-strong rounded-circle"
                        alt="" />
                </div>
                <!-- nombre y fecha col-md-9 col-sm-8  -->
                <div class="col-md-10 col-9 d-flex pl-2 pt-3">
                    <p class="h4 m-0 d-inline"><strong>{{publicacion.autor}}</strong></p>
                    <p class="blockquote-footer d-inline pt-1 ml-3">{{publicacion.fecha_hora}}</p>
                </div>

                <!-- dropdown -->
                <a class="nav-link col-1" href="#" id="dropdownId" data-toggle="dropdown" aria-haspopup="true"
                    aria-expanded="false">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                        class="bi bi-three-dots-vertical" viewBox="0 0 16 16">
                        <path
                            d="M9.5 13a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0z" />
                    </svg>
                </a>
                <div class="dropdown-menu bg-dark" aria-labelledby="dropdownId">
                    <a class="btn-btn-danger" href="/borrar_publicacion/{{publicacion.id}}">eliminar</a>
                </div>

            </div>

            <!-- contenido de la publicacion -->
            <div class="col-12 row mx-0 px-0 py-3 separador-top separador-bottom mb-3">
                <p class="col-12 lead">{{publicacion.descripcion}}</p>
            </div>

            <!-- seccion de respuestas -->
            {% for comentario in comentarios %}
                {% if comentario.id_publicacion == publicacion.id %}
                    <div class="col-1">
                    </div>
                    <div class="row  m-0 p-0 col-11">
                        <!-- foto de perfil de comentario-->
                        <div class="col-md-1 col-2 my-2">
                            <img class="shadow-1-strong rounded-circle" src="../static/img/gato{{ range(1, 18) | random }}.png"
                                alt="" />
                        </div>

                        <!-- nombre y fecha del comentario-->
                        <div class="col-md-10 col-9 d-flex pt-3">
                            <p class="h4 m-0 d-inline"><strong>{{comentario.autor}}</strong></p>
                            <p class="blockquote-footer d-inline pt-1 ml-3">{{comentario.fecha_hora}}</p>
                        </div>

                        <!-- eliminar el comentario-->
                        <a class="btn-btn-danger col-1" href="/borrar_comentario/{{comentario.id}}">X</a>

                        <!-- contenido del comentario -->
                        <div class="col-12 row mx-0 px-0 py-3 separador-top">
                            <p class="col-12 lead">{{comentario.descripcion}}</p>
                        </div>
                    </div>
                {% endif %}
            {% endfor %}
            <form class="row mx-0 w-100" action="/agregar_comentario" method="POST">
                <input type="hidden" name="id_publicacion" value="{{ publicacion.id }}">

                <select class="col-lg-3 col-12" name="autor" id="select">
                    {% for usuario in usuarios %}
                        <option value="{{usuario.nombre}}">{{usuario.nombre}}</option>
                    {% endfor %}
                </select>

                <input class="form-control col-lg-7 col-8" type="text" name="descripcion" placeholder="comenta algo">

                <button class="btn btn-submit btn-outline-primary p-0 col-lg-2 col-3" type="submit" style="font-size: 25px;">➢</button>
            </form>
        </div>
        {% endfor %}
    </div>
</section>

{%endblock%}